<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AttendAI Dashboard</title>
  <link rel="stylesheet" href="/static/styles.css?v=18">
  <style>
    .container{max-width:1400px;margin:16px auto;padding:16px}
    .toolbar{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .btn{background:#4a63e7;color:#fff;border:none;border-radius:10px;padding:10px 16px;font-weight:700;cursor:pointer}
    .btn.warn{background:#e74a4a}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .row-title{font-size:1.4rem;margin:24px 0 8px}
    .card{background:#fff;border-radius:14px;padding:16px;border:1px solid #eee}
    .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:20px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid #eee;text-align:left}
    #qrBox{display:none;margin-top:10px;justify-content:center;align-items:center;min-height:360px;border:1px dashed #cfd3ff;border-radius:14px;background:#f7f8ff;flex-direction:column;gap:8px}
    #qrBox img{width:280px;height:280px;object-fit:contain}
    .muted{color:#666;font-size:.9rem}
    .right{margin-left:auto}
    .nowrap{white-space:nowrap}
  </style>
</head>
<body>
<div class="container">
  <h1>대시보드</h1>

  <div class="toolbar">
    <label for="sessionSel">세션 선택</label>
    <select id="sessionSel" class="nowrap"></select>

    <button id="btnStart" class="btn">출석체크 시작</button>
    <button id="btnManual" class="btn">임의 출석 입력</button>
    <button id="btnManualExcuse" class="btn">임의 공결 입력</button>
    <button id="btnDelete" class="btn warn" style="display:none">세션 삭제</button>

    <button id="btnGmail" class="btn">Gmail 불러오기</button>
    <button id="btnCSV" class="btn">세션 출석 CSV</button>
    <button id="btnCSVExcuse" class="btn">전체 공결 CSV</button>
    <button id="btnCSVAll" class="btn">전체 출석 CSV</button>
    <button id="btnAnalyze" class="btn">분석하기</button>

    <span id="hint" class="muted right"></span>
  </div>

  <!-- QR 보드 -->
  <div id="qrBox" class="card">
    <div class="muted" id="qrMeta">QR 준비중…</div>
    <img id="qrImg" alt="qr">
    <div class="muted">자동 갱신까지 <b id="qrCountdown">15</b>초</div>
  </div>

  <div class="grid" style="margin-top:18px">
    <div class="card">
      <div class="row-title">출석 로그</div>
      <table id="logsTbl">
        <thead>
          <tr><th>학번</th><th>시각</th><th>기기</th><th>IP</th><th>비고</th><th>관리</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="card">
      <div class="row-title">공결 내역</div>
      <table id="excuseTbl">
        <thead>
          <tr><th>날짜</th><th>학번</th><th>사유</th><th>증빙</th><th>비고</th><th>관리</th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="excusePager" class="muted" style="margin-top:8px; display:flex; gap:8px; align-items:center;"></div>

      <div class="row-title">의심 내역</div>
      <table id="susTbl">
        <thead>
          <tr><th>학번</th><th>의심 사유</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<script src="/static/dashboard.js?v=42"></script>
</body>
</html>
